<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Category Filtering Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .event-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .category-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 12px;
            background: rgba(0,0,0,0.05);
            border-radius: 20px;
            font-size: 14px;
        }
        .category-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .templates-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .filter-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .filter-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        .filter-btn:hover {
            background: #f8f9fa;
        }
        .filter-btn.active:hover {
            background: #0056b3;
        }
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .template-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            transition: transform 0.2s;
        }
        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .template-image {
            width: 100%;
            height: 180px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
        }
        .template-content {
            padding: 16px;
        }
        .template-name {
            font-weight: bold;
            margin-bottom: 8px;
        }
        .template-price {
            color: #28a745;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 8px;
        }
        .template-category {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .stat {
            color: #666;
        }
        .stat strong {
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Template Category Filtering Test</h1>
    
    <div class="event-info">
        <h2>Event Information</h2>
        <div id="event-details">
            <p><strong>Event:</strong> <span id="event-title">Loading...</span></p>
            <p><strong>Category:</strong> <span id="event-category">Loading...</span></p>
        </div>
    </div>

    <div class="templates-section">
        <h2>Available Templates</h2>
        
        <div class="filter-controls">
            <span>Filter by:</span>
            <button class="filter-btn active" onclick="showAllTemplates()">All Templates</button>
            <button class="filter-btn" id="category-filter-btn" onclick="showCategoryTemplates()">Category Templates</button>
        </div>

        <div class="stats">
            <div class="stat">Total Templates: <strong id="total-count">0</strong></div>
            <div class="stat">Showing: <strong id="showing-count">0</strong></div>
            <div class="stat">Filter: <strong id="current-filter">All</strong></div>
        </div>

        <div id="templates-grid" class="templates-grid">
            <div>Loading templates...</div>
        </div>
    </div>

    <script>
        // Mock data based on the API responses we saw
        const mockEvent = {
            id: "e59d660a-3578-4fae-ad18-d37efe906dd8",
            title: "Sample Event 4",
            category: 1,
            category_name: "Technology",
            category_color: "#3498db"
        };

        const mockTemplates = [
            {
                id: 1,
                name: "Modern Conference",
                preview_image: "http://127.0.0.1:8000/media/event_templates/previews/Artboard_31080x_qRhIbKU.webp",
                package_plan: {
                    id: 1,
                    name: "Premium Plan",
                    price: "299.00",
                    features: ["Custom colors", "Premium fonts", "Video backgrounds"],
                    category: {
                        id: 1,
                        name: "Technology",
                        color: "#3498db"
                    }
                }
            },
            {
                id: 2,
                name: "Corporate Professional",
                preview_image: "http://127.0.0.1:8000/media/event_templates/previews/Artboard_3.webp",
                package_plan: {
                    id: 4,
                    name: "Business Plan",
                    price: "199.00",
                    features: ["Professional layouts", "Corporate colors"],
                    category: {
                        id: 2,
                        name: "Business",
                        color: "#e74c3c"
                    }
                }
            },
            {
                id: 3,
                name: "Creative Showcase",
                preview_image: "http://127.0.0.1:8000/media/event_templates/previews/Artboard_1.png",
                package_plan: {
                    id: 3,
                    name: "Creative Plan",
                    price: "249.00",
                    features: ["Artistic designs", "Creative layouts"],
                    category: {
                        id: 1,
                        name: "Technology",
                        color: "#3498db"
                    }
                }
            },
            {
                id: 4,
                name: "Wedding Elegance",
                preview_image: "#",
                package_plan: {
                    id: 5,
                    name: "Wedding Plan",
                    price: "399.00",
                    features: ["Romantic themes", "Elegant fonts", "Photo galleries"],
                    category: {
                        id: 5,
                        name: "Wedding",
                        color: "#9b59b6"
                    }
                }
            },
            {
                id: 5,
                name: "Tech Summit",
                preview_image: "#",
                package_plan: {
                    id: 6,
                    name: "Tech Plan",
                    price: "349.00",
                    features: ["Modern UI", "Interactive elements", "Code snippets"],
                    category: {
                        id: 1,
                        name: "Technology",
                        color: "#3498db"
                    }
                }
            }
        ];

        let allTemplates = mockTemplates;
        let currentTemplates = mockTemplates;
        let showingFiltered = false;

        function initializePage() {
            // Display event info
            document.getElementById('event-title').textContent = mockEvent.title;
            document.getElementById('event-category').innerHTML = `
                <span class="category-badge">
                    <span class="category-dot" style="background-color: ${mockEvent.category_color}"></span>
                    ${mockEvent.category_name}
                </span>
            `;

            // Update category filter button
            document.getElementById('category-filter-btn').textContent = `${mockEvent.category_name} Only`;

            // Apply initial filter (show category templates by default)
            showCategoryTemplates();
        }

        function renderTemplates(templates) {
            const grid = document.getElementById('templates-grid');
            
            if (templates.length === 0) {
                grid.innerHTML = '<div>No templates available for this category.</div>';
                return;
            }

            grid.innerHTML = templates.map(template => `
                <div class="template-card">
                    <div class="template-image">
                        ${template.preview_image !== '#' ? 
                            `<img src="${template.preview_image}" alt="${template.name}" width="100%" height="100%" style="object-fit: cover;">` :
                            `Template Preview`
                        }
                    </div>
                    <div class="template-content">
                        <div class="template-name">${template.name}</div>
                        <div class="template-price">$${template.package_plan.price}</div>
                        <div class="template-category">
                            <span class="category-badge">
                                <span class="category-dot" style="background-color: ${template.package_plan.category.color}"></span>
                                ${template.package_plan.category.name}
                            </span>
                        </div>
                        <div class="template-features">
                            ${template.package_plan.features.slice(0, 2).map(feature => 
                                `<div style="font-size: 12px; color: #666;">✓ ${feature}</div>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `).join('');

            updateStats(templates.length);
        }

        function updateStats(showingCount) {
            document.getElementById('total-count').textContent = allTemplates.length;
            document.getElementById('showing-count').textContent = showingCount;
            document.getElementById('current-filter').textContent = showingFiltered ? mockEvent.category_name : 'All';
        }

        function showAllTemplates() {
            currentTemplates = allTemplates;
            showingFiltered = false;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.filter-btn')[0].classList.add('active');
            
            renderTemplates(currentTemplates);
        }

        function showCategoryTemplates() {
            const categoryTemplates = allTemplates.filter(template => 
                template.package_plan.category.id === mockEvent.category ||
                template.package_plan.category.name === mockEvent.category_name
            );
            
            currentTemplates = categoryTemplates;
            showingFiltered = true;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('category-filter-btn').classList.add('active');
            
            renderTemplates(currentTemplates);
        }

        // Initialize the page
        initializePage();
    </script>
</body>
</html>